Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='AAPL_intraday_336_96', model='PatchTST', data='custom', root_path='./predictor/dataset/', data_path='AAPL_intraday.csv', features='M', target='OT', freq='h', checkpoints='./predictor/checkpoints/', seq_len=336, label_len=48, pred_len=96, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=256, patience=20, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : AAPL_intraday_336_96_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17318
val 2441
test 4976
Epoch: 1 cost time: 3.2958929538726807
Epoch: 1, Steps: 67 | Train Loss: 0.6853536 Vali Loss: 0.0390440 Test Loss: 0.1448647
Validation loss decreased (inf --> 0.039044).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 2.4414777755737305
Epoch: 2, Steps: 67 | Train Loss: 0.5312869 Vali Loss: 0.0327168 Test Loss: 0.1224186
Validation loss decreased (0.039044 --> 0.032717).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 2.381545066833496
Epoch: 3, Steps: 67 | Train Loss: 0.4256335 Vali Loss: 0.0305289 Test Loss: 0.1071247
Validation loss decreased (0.032717 --> 0.030529).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 2.8336994647979736
Epoch: 4, Steps: 67 | Train Loss: 0.3833529 Vali Loss: 0.0297497 Test Loss: 0.1026159
Validation loss decreased (0.030529 --> 0.029750).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 2.5427002906799316
Epoch: 5, Steps: 67 | Train Loss: 0.3663299 Vali Loss: 0.0288949 Test Loss: 0.0981558
Validation loss decreased (0.029750 --> 0.028895).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 2.4560015201568604
Epoch: 6, Steps: 67 | Train Loss: 0.3544203 Vali Loss: 0.0285489 Test Loss: 0.0958570
Validation loss decreased (0.028895 --> 0.028549).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 3.846146821975708
Epoch: 7, Steps: 67 | Train Loss: 0.3487465 Vali Loss: 0.0285811 Test Loss: 0.0940079
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 3.417433977127075
Epoch: 8, Steps: 67 | Train Loss: 0.3440283 Vali Loss: 0.0282621 Test Loss: 0.0924243
Validation loss decreased (0.028549 --> 0.028262).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 2.4488375186920166
Epoch: 9, Steps: 67 | Train Loss: 0.3388869 Vali Loss: 0.0283177 Test Loss: 0.0916234
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 2.427232027053833
Epoch: 10, Steps: 67 | Train Loss: 0.3334133 Vali Loss: 0.0283954 Test Loss: 0.0900090
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 2.430917739868164
Epoch: 11, Steps: 67 | Train Loss: 0.3359575 Vali Loss: 0.0282481 Test Loss: 0.0892734
Validation loss decreased (0.028262 --> 0.028248).  Saving model ...
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 2.5238876342773438
Epoch: 12, Steps: 67 | Train Loss: 0.3295947 Vali Loss: 0.0286661 Test Loss: 0.0885540
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 2.4856343269348145
Epoch: 13, Steps: 67 | Train Loss: 0.3266361 Vali Loss: 0.0283849 Test Loss: 0.0878399
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 2.419081211090088
Epoch: 14, Steps: 67 | Train Loss: 0.3252622 Vali Loss: 0.0285683 Test Loss: 0.0871693
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 2.4456188678741455
Epoch: 15, Steps: 67 | Train Loss: 0.3257655 Vali Loss: 0.0283757 Test Loss: 0.0866373
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 2.471963882446289
Epoch: 16, Steps: 67 | Train Loss: 0.3161719 Vali Loss: 0.0282130 Test Loss: 0.0861901
Validation loss decreased (0.028248 --> 0.028213).  Saving model ...
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 2.472539186477661
Epoch: 17, Steps: 67 | Train Loss: 0.3229417 Vali Loss: 0.0279401 Test Loss: 0.0858177
Validation loss decreased (0.028213 --> 0.027940).  Saving model ...
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 2.541402816772461
Epoch: 18, Steps: 67 | Train Loss: 0.3234445 Vali Loss: 0.0282002 Test Loss: 0.0854478
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 2.441520929336548
Epoch: 19, Steps: 67 | Train Loss: 0.3232388 Vali Loss: 0.0273491 Test Loss: 0.0852327
Validation loss decreased (0.027940 --> 0.027349).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 2.4703352451324463
Epoch: 20, Steps: 67 | Train Loss: 0.3221815 Vali Loss: 0.0281644 Test Loss: 0.0850067
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 3.648409128189087
Epoch: 21, Steps: 67 | Train Loss: 0.3188125 Vali Loss: 0.0284522 Test Loss: 0.0846464
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 2.431792974472046
Epoch: 22, Steps: 67 | Train Loss: 0.3210700 Vali Loss: 0.0279999 Test Loss: 0.0843984
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 2.4612929821014404
Epoch: 23, Steps: 67 | Train Loss: 0.3213413 Vali Loss: 0.0278346 Test Loss: 0.0841722
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 2.4932501316070557
Epoch: 24, Steps: 67 | Train Loss: 0.3163757 Vali Loss: 0.0279518 Test Loss: 0.0840478
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 2.5223660469055176
Epoch: 25, Steps: 67 | Train Loss: 0.3170574 Vali Loss: 0.0279733 Test Loss: 0.0838400
EarlyStopping counter: 6 out of 20
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 2.4350779056549072
Epoch: 26, Steps: 67 | Train Loss: 0.3191736 Vali Loss: 0.0278437 Test Loss: 0.0837529
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 2.5056395530700684
Epoch: 27, Steps: 67 | Train Loss: 0.3190958 Vali Loss: 0.0279546 Test Loss: 0.0836705
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 2.5227973461151123
Epoch: 28, Steps: 67 | Train Loss: 0.3198510 Vali Loss: 0.0282530 Test Loss: 0.0835023
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 2.4579684734344482
Epoch: 29, Steps: 67 | Train Loss: 0.3191587 Vali Loss: 0.0276934 Test Loss: 0.0835093
EarlyStopping counter: 10 out of 20
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 2.4555306434631348
Epoch: 30, Steps: 67 | Train Loss: 0.3138673 Vali Loss: 0.0276280 Test Loss: 0.0834428
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 2.4312312602996826
Epoch: 31, Steps: 67 | Train Loss: 0.3157574 Vali Loss: 0.0284353 Test Loss: 0.0833519
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 2.506152391433716
Epoch: 32, Steps: 67 | Train Loss: 0.3134689 Vali Loss: 0.0280479 Test Loss: 0.0833506
EarlyStopping counter: 13 out of 20
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 2.5379250049591064
Epoch: 33, Steps: 67 | Train Loss: 0.3166550 Vali Loss: 0.0286742 Test Loss: 0.0832807
EarlyStopping counter: 14 out of 20
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 2.4553537368774414
Epoch: 34, Steps: 67 | Train Loss: 0.3175478 Vali Loss: 0.0284852 Test Loss: 0.0832227
EarlyStopping counter: 15 out of 20
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 2.6074438095092773
Epoch: 35, Steps: 67 | Train Loss: 0.3167954 Vali Loss: 0.0279500 Test Loss: 0.0832195
EarlyStopping counter: 16 out of 20
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 3.024395704269409
Epoch: 36, Steps: 67 | Train Loss: 0.3163481 Vali Loss: 0.0285025 Test Loss: 0.0831608
EarlyStopping counter: 17 out of 20
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 2.4123568534851074
Epoch: 37, Steps: 67 | Train Loss: 0.3107539 Vali Loss: 0.0285123 Test Loss: 0.0830951
EarlyStopping counter: 18 out of 20
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 2.5013017654418945
Epoch: 38, Steps: 67 | Train Loss: 0.3150510 Vali Loss: 0.0284667 Test Loss: 0.0830533
EarlyStopping counter: 19 out of 20
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 2.4543979167938232
Epoch: 39, Steps: 67 | Train Loss: 0.3141615 Vali Loss: 0.0287683 Test Loss: 0.0830738
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : AAPL_intraday_336_96_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4976
mse:0.0852327048778534, mae:0.07027249038219452, rse:0.5131227970123291
