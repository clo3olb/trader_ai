Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=256, c_out=7, d_ff=256, d_model=128, data='custom', data_path='PG.csv', date_header='Timestamp', dec_in=19, decoder_layers=1, decomposition=1, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=19, factor=1, fc_dropout=0.2, features='M', freq='1d', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='PatchTST_PG_336_96', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=96, random_seed=2024, result_path='./predictor/results/', revin=1, root_path='./predictor/dataset/', seq_len=336, stride=8, subtract_last=0, target='Close', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : PatchTST_PG_336_96>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6120
val 842
test 1776
Epoch: 1 cost time: 27.680665254592896
Epoch: 1, Steps: 23 | Train Loss: 0.7212006 Vali Loss: 0.4903436 Test Loss: 0.4495628
Validation loss decreased (inf --> 0.490344).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 27.653682231903076
Epoch: 2, Steps: 23 | Train Loss: 0.6081275 Vali Loss: 0.4041078 Test Loss: 0.3605628
Validation loss decreased (0.490344 --> 0.404108).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 27.53861117362976
Epoch: 3, Steps: 23 | Train Loss: 0.5339109 Vali Loss: 0.3677697 Test Loss: 0.3497249
Validation loss decreased (0.404108 --> 0.367770).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 27.689898252487183
Epoch: 4, Steps: 23 | Train Loss: 0.4985210 Vali Loss: 0.3570258 Test Loss: 0.3386288
Validation loss decreased (0.367770 --> 0.357026).  Saving model ...
Updating learning rate to 9e-05
