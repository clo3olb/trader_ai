Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, d_ff=256, d_model=128, data='custom', data_path='CVX_with_sentiment.csv', date_header='Timestamp', dec_in=20, decoder_layers=1, decomposition=1, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=20, factor=1, fc_dropout=0.2, features='M', freq='1d', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='PatchTST_CVX_with_sentiment_336_96', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=96, random_seed=2024, result_path='./predictor/results/', revin=1, root_path='./predictor/dataset/', seq_len=336, stride=8, subtract_last=0, target='Close', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : PatchTST_CVX_with_sentiment_336_96>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6841
val 945
test 1982
Epoch: 1 cost time: 36.959924936294556
Epoch: 1, Steps: 53 | Train Loss: 0.7559730 Vali Loss: 0.8552231 Test Loss: 0.6218310
Validation loss decreased (inf --> 0.855223).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 36.33344531059265
Epoch: 2, Steps: 53 | Train Loss: 0.5922747 Vali Loss: 0.5833716 Test Loss: 0.5564390
Validation loss decreased (0.855223 --> 0.583372).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 37.158719539642334
Epoch: 3, Steps: 53 | Train Loss: 0.4976769 Vali Loss: 0.5277426 Test Loss: 0.5182822
Validation loss decreased (0.583372 --> 0.527743).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 36.441457748413086
Epoch: 4, Steps: 53 | Train Loss: 0.4654453 Vali Loss: 0.5013654 Test Loss: 0.5087380
Validation loss decreased (0.527743 --> 0.501365).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 36.67188334465027
Epoch: 5, Steps: 53 | Train Loss: 0.4502808 Vali Loss: 0.5022246 Test Loss: 0.4984297
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 36.54800033569336
Epoch: 6, Steps: 53 | Train Loss: 0.4425364 Vali Loss: 0.5085500 Test Loss: 0.4961013
EarlyStopping counter: 2 out of 20
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 36.54772663116455
Epoch: 7, Steps: 53 | Train Loss: 0.4364270 Vali Loss: 0.5088502 Test Loss: 0.4907282
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 36.505799770355225
Epoch: 8, Steps: 53 | Train Loss: 0.4319685 Vali Loss: 0.5052814 Test Loss: 0.4880891
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 36.5617949962616
Epoch: 9, Steps: 53 | Train Loss: 0.4284254 Vali Loss: 0.5073388 Test Loss: 0.4890179
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 36.95924139022827
Epoch: 10, Steps: 53 | Train Loss: 0.4243916 Vali Loss: 0.5077602 Test Loss: 0.4872683
EarlyStopping counter: 6 out of 20
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 36.51414227485657
Epoch: 11, Steps: 53 | Train Loss: 0.4219759 Vali Loss: 0.5087654 Test Loss: 0.4890611
EarlyStopping counter: 7 out of 20
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 36.594666957855225
Epoch: 12, Steps: 53 | Train Loss: 0.4193479 Vali Loss: 0.5149452 Test Loss: 0.4845976
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 36.621607065200806
Epoch: 13, Steps: 53 | Train Loss: 0.4161159 Vali Loss: 0.5101467 Test Loss: 0.4841052
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 36.44544863700867
Epoch: 14, Steps: 53 | Train Loss: 0.4147662 Vali Loss: 0.5117826 Test Loss: 0.4860655
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 36.52389454841614
Epoch: 15, Steps: 53 | Train Loss: 0.4119839 Vali Loss: 0.5123446 Test Loss: 0.4882008
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 36.658940076828
Epoch: 16, Steps: 53 | Train Loss: 0.4097530 Vali Loss: 0.5121101 Test Loss: 0.4881630
EarlyStopping counter: 12 out of 20
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 36.96307682991028
Epoch: 17, Steps: 53 | Train Loss: 0.4095820 Vali Loss: 0.5099872 Test Loss: 0.4895669
EarlyStopping counter: 13 out of 20
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 36.58130645751953
Epoch: 18, Steps: 53 | Train Loss: 0.4069894 Vali Loss: 0.5187913 Test Loss: 0.4905910
EarlyStopping counter: 14 out of 20
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 36.660624742507935
Epoch: 19, Steps: 53 | Train Loss: 0.4056508 Vali Loss: 0.5177623 Test Loss: 0.4909858
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 36.52345418930054
Epoch: 20, Steps: 53 | Train Loss: 0.4043300 Vali Loss: 0.5134864 Test Loss: 0.4894933
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 36.52394199371338
Epoch: 21, Steps: 53 | Train Loss: 0.4032217 Vali Loss: 0.5168568 Test Loss: 0.4911259
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 36.65656042098999
Epoch: 22, Steps: 53 | Train Loss: 0.4021070 Vali Loss: 0.5163373 Test Loss: 0.4906678
EarlyStopping counter: 18 out of 20
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 36.64949417114258
Epoch: 23, Steps: 53 | Train Loss: 0.4011127 Vali Loss: 0.5167216 Test Loss: 0.4902323
EarlyStopping counter: 19 out of 20
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 36.94589352607727
Epoch: 24, Steps: 53 | Train Loss: 0.4009133 Vali Loss: 0.5205564 Test Loss: 0.4924739
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : PatchTST_CVX_with_sentiment_336_96<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1982
mse:5570231296.0, mae:6788.01416015625, rse:0.9420159459114075
